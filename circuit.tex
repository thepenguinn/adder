\documentclass[a4paper, 10pt]{article}
\usepackage[siunitx]{circuitikz}
\begin{document}

% \def\normalcoord(#1){coordinate(#1)}
% \def\showcoord(#1){coordinate(#1) node[circle, red, draw, inner sep=1pt,
% pin={[red, overlay, inner sep=0.5pt, font=\tiny, pin distance=0.1cm,
% pin edge={red, overlay}]45:#1}](){}}
% \let\coord=\normalcoord
% \let\coord=\showcoord

\usetikzlibrary{intersections}

\ctikzsubcircuitdef{gateAND} {A, B, O, V, G} {
	coordinate(#1-A) -- ++(0.5,0) to[R, l=~, name=#1-r1]
	++(2,0) node(#1-nb1)[npn, anchor=B]{}
	(#1-nb1.E) node(#1-nb2)[npn, anchor=C]{} (#1-nb2.B)
	to[R, l=~, name=#1-r2] ++(-2,0) -- ++(-0.5,0) coordinate(#1-B)
	(#1-nb2.E) to[short, *-] ++(0,-0.5) coordinate(#1-G)
	(#1-nb1.C) to[short, *-] ++(1,0) node(#1-nb3)[npn, anchor=B]{}
	(#1-nb3.C) to[R, l=~, name=#1-r3] ++(0,2)
	(#1-nb1.C) -- (#1-nb1.C|-#1-nb3.C) to[R, l=~, name=#1-r4] ++(0,2)
	coordinate(#1-Vbr) to[short, *-] (#1-Vbr-|#1-nb3)
	(#1-Vbr) -- ++(0,0.5) coordinate(#1-V)
	(#1-nb3.C) to[short, *-] ++(2,0) -- ++(0.5,0) coordinate(#1-O)
	(#1-nb2.E) -| (#1-nb3.E)
}

\ctikzsubcircuitdef{gateOR} {A, B, O, V, G} {
	coordinate(#1-A) -- ++(0.5,0) to[R, l=~, name=#1-r1]
	++(2,0) -- ++(1,0) node(#1-nb1)[npn, anchor=B] {}
	(#1-nb1.C) to[short, *-] ++(-1,0) -- ++(0,-1.5)
	node(#1-nb2)[npn, anchor=C]{} (#1-nb2.B) to[R, l=~, name=#1-r2]
	++(-2,0) -- ++(-0.5,0) coordinate(#1-B)
	(#1-nb2.E) to[short, -*] (#1-nb1.E|-#1-nb2.E) -- (#1-nb1.E)
	(#1-nb1.E|-#1-nb2.E) -- ++(0,-0.5) coordinate(#1-G)
	(#1-nb1.C) -- ++(1,0) node(#1-nb3)[npn, anchor=B]{}
	(#1-nb3.C) to[short, *-] ++(2,0) -- ++(0.5,0) coordinate(#1-O)
	(#1-nb1.C) to[short, *-] (#1-nb1.C|-#1-nb3.C)
	to[R, l=~, name=#1-r3] ++(0,2) coordinate(#1-Vbr)
	(#1-nb3.C) to[R, l=~, name=#1-r4] ++(0,2)
	-- (#1-Vbr) to[short, *-] ++(0,0.5) coordinate(#1-V)
	(#1-nb3.E) -- (#1-nb3.E|-#1-nb2.E) -- (#1-nb1.E|-#1-nb2.E)
}

\ctikzsubcircuitdef{gateXOR} {A, B, O, V, G} {
	coordinate(#1-A) -- ++(1,0) to[short, -*] ++(1.5,0)
	coordinate(#1-Abr) -- ++(1.5,0)
	to[R, l=~, name=#1-r1] ++(2,0) -- ++(1,0)
	node(#1-nb1)[npn, anchor=B]{}
	(#1-nb1.C) to[short, *-] ++(-1,0) -- ++(0,-1.5)
	node(#1-nb2)[npn, anchor=C]{}
	(#1-nb2.E) to[short, -*] (#1-nb2.E-|#1-nb1.E)
	-- (#1-nb1.E)
	(#1-nb2.B) to[R, l=~, name=#1-r2] ++(-2,0)
	-- (#1-Abr|-#1-nb2.B) to[short, -*] ++(-1.5,0)
	coordinate(#1-Bbr) -- (#1-A|-#1-nb2.B)
	coordinate(#1-B)
	(#1-Abr) -- (#1-Abr|-#1-Bbr) -- ++(0,-1)
	to[R, l=~, name=#1-r3] ++(0,-2)
	-- ++(0,-1)
	node(#1-nb3)[npn, anchor=B]{}
	(#1-nb3.E) node(#1-nb4)[npn, anchor=C]{}
	(#1-nb4.B) -- (#1-Bbr|-#1-nb4.B) -- ++(0,1)
	to[R, l=~, name=#1-r4] ++(0,2) -- (#1-Bbr)
	(#1-nb1.C) -- ++(1,0) node(#1-nb5)[npn, anchor=B]{}
	(#1-nb5.C) to[short, *-] ++(2,0) -- ++(0.5,0)
	coordinate(#1-O)
	(#1-nb1.C) -- (#1-nb1.C|-#1-nb5.C)
	-- ++(0,0.5)
	to[R, l=~, name=#1-r5, -*] ++(0,2)
	coordinate(#1-Vbr)
	-- (#1-nb3.C|-#1-Vbr)
	to[R, l=~, name=#1-r6] ++(0,-2) -- (#1-nb3.C)
	(#1-nb5.C) -- ++(0,0.5)
	coordinate(#1-Obr)
	to[short, -*] (#1-nb3|-#1-Obr)
	(#1-Vbr) -- ++(0,0.5)
	coordinate(#1-V)
	(#1-nb4.E) to[short, -*] (#1-nb4.E-|#1-nb1.E)
	-- (#1-nb2.E-|#1-nb1.E)
	(#1-nb5.E) -- (#1-nb4.E-|#1-nb5.E)
	-- (#1-nb4.E-|#1-nb1.E)
	-- ++(0,-0.5)
	coordinate(#1-G)
}

\ctikzsubcircuitactivate{gateOR}
\ctikzsubcircuitactivate{gateAND}
\ctikzsubcircuitactivate{gateXOR}

\newcommand\myOR[9] {
	\gateOR{#1}{#2} (#1-r1.n) node[above]{#3}
	(#1-r2.n) node[below]{#4}
	(#1-r3.n) node[left]{#5}
	(#1-r4.n) node[left]{#6}
	(#1-nb1) node[right]{#7}
	(#1-nb2) node[right]{#8}
	(#1-nb3) node[right]{#9}
}

\newcommand\myAND[9] {
	\gateAND{#1}{#2} (#1-r1.n) node[above]{#3}
	(#1-r2.n) node[below]{#4}
	(#1-r3.n) node[left]{#5}
	(#1-r4.n) node[left]{#6}
	(#1-nb1) node[right]{#7}
	(#1-nb2) node[right]{#8}
	(#1-nb3) node[right]{#9}
}

\newcommand\myXOR[7] {
	\gateXOR{#1}{#2}
	(#1-nb1) node[right]{#3}
	(#1-nb2) node[right]{#4}
	(#1-nb3) node[right]{#5}
	(#1-nb4) node[right]{#6}
	(#1-nb5) node[right]{#7}
}

\newcommand\labelXORresistor[7] {
	(#1-r1.n) node[above]{#2}
	(#1-r2.n) node[below]{#3}
	(#1-r3.south) node[left]{#4}
	(#1-r4.n) node[left]{#5}
	(#1-r5.n) node[left]{#6}
	(#1-r6.s) node[left]{#7}
}

\begin{figure}
	\centering
	\begin{circuitikz}[american]

		\draw (0,0)
		coordinate(A)
		node()[left=4pt]{A}
		to[short, o-] ++(1,0)
		coordinate(Bbr-above) to[short, -*] ++(0.75,0)
		coordinate(Abr)
		-- ++(0.5,0)
		node(G1)[xor port, anchor=in 1]{}
		(G1.south) node(G1-name)[below=8pt]{XOR}
		(G1.in 2) to[short, -*] (Bbr-above|-G1.in 2)
		coordinate(Bbr)
		to[short, -o] (A|-G1.in 2)
		node[left=4pt]{B}
		(Abr) -- (Abr|-G1-name) -- ++(0,-1)
		coordinate(tmp)
		-- (tmp -| G1.in 2)
		node(G2)[and port, anchor=in 1]{}
		(G2.south) node(G2-name)[below=8pt]{AND}
		(G2.in 2) -| (Bbr)
		(G1.out) to[short, -o] ++(1,0)
		coordinate(tmp)
		node()[right=4pt]{S}
		(G2.out) to[short, -o] (G2.out-|tmp)
		node()[right=4pt]{$C_{out}$}
		;

	\end{circuitikz}
	\caption{Half Adder}
\end{figure}


\begin{figure}
	\centering
	\begin{circuitikz}[american]

		\draw (0,0) \myAND{G1}{A}{$R_1$}{$R_2$}{$R_3$}{$R_4$}
		{$Q_1$}{$Q_2$}{$Q_3$};

		\draw (G1-A) node[ocirc] {};
		\draw (G1-A) node[left=4pt] {A};

		\draw (G1-B) node[ocirc] {};
		\draw (G1-B) node[left=4pt] {B};

		\draw (G1-O) node[ocirc] {};
		\draw (G1-O) node[right=4pt] {O};

		\draw (G1-V) node[vcc](VCC){$V_{CC}$};
		\draw (G1-G) node[ground](GND){};

	\end{circuitikz}
	\caption{AND Gate}
\end{figure}

\begin{figure}
	\centering
	\begin{circuitikz}[american]

		\draw (0,0) \myOR{G1}{A}{$R_1$}{$R_2$}{$R_3$}{$R_3$}
		{$Q_1$}{$Q_2$}{$Q_3$};

		\draw (G1-A) node[ocirc] {};
		\draw (G1-A) node[left=4pt] {A};

		\draw (G1-B) node[ocirc] {};
		\draw (G1-B) node[left=4pt] {B};

		\draw (G1-O) node[ocirc] {};
		\draw (G1-O) node[right=4pt] {O};

		\draw (G1-V) node[vcc](VCC){$V_{CC}$};
		\draw (G1-G) node[ground](GND){};

	\end{circuitikz}
	\caption{OR Gate}
\end{figure}

\begin{figure}
	\centering
	\begin{circuitikz}[american]

		\draw (0,0) \myXOR{G1}{A} {$Q_1$} {$Q_2$} {$Q_3$} {$Q_4$} {$Q_5$};
		\draw \labelXORresistor{G1} {$R_1$} {$R_2$} {$R_3$} {$R_4$} {$R_5$} {$R_6$};

		\draw (G1-A) node[ocirc] {};
		\draw (G1-A) node[left=4pt] {A};

		\draw (G1-B) node[ocirc] {};
		\draw (G1-B) node[left=4pt] {B};

		\draw (G1-O) node[ocirc] {};
		\draw (G1-O) node[right=4pt] {O};

		\draw (G1-V) node[vcc](VCC){$V_{CC}$};
		\draw (G1-G) node[ground](GND){};

	\end{circuitikz}
	\caption{XOR Gate}
\end{figure}

% \begin{figure}
% 	\centering
% 	\begin{circuitikz}[>=Stealth, american]
%
% 		\myAND{G1}{(0,0)}{$R_1$}{$R_2$}{$R_3$};
% 		\myAND{G2}{(G1-O)}{$R_4$}{$R_5$}{$R_6$};
%
% 		\path (G1-B) -- ++(-3,-2) coordinate(G3-begin);
%
% 		\myAND{G3}{(G3-begin)}{$R_7$}{$R_8$}{$R_9$};
%
%
% 		\node [ocirc] at (G1-A) {};
% 		\node [left=4pt] at (G1-A) {A};
%
% 		\node [ocirc] at (G1-B) {};
% 		\node [left=4pt] at (G1-B) {B};
%
% 		\node [ocirc] at (G1-V) {};
% 		\node [above=4pt] at (G1-V) {$V_{CC}$};
%
% 		\node [ocirc] at (G2-V) {};
% 		\node [above=4pt] at (G2-V) {$V_{CC}$};
%
% 	\end{circuitikz}
% 	\caption{Another AND Gate}
% \end{figure}

\end{document}
